main <- input
#Annotate Entrez Gene ID
#Obtain dataframe of Gene ID mapped to HGNC Symbol
mapped_HGNC <- as.data.frame(org.Hs.egSYMBOL[mappedkeys(org.Hs.egSYMBOL)])
#Map Entrez Gene ID to HGNC Symbols in main dataframe
for (i in 1:nrow(main)){
index = as.numeric(which(main[i,1] == mapped_HGNC$symbol))
if (length(index) == 1)
{main[i,3] <- mapped_HGNC$gene_id[index]}
else {main[i,3] <- NA}
}
colnames(main) <- c("Hugo_Symbol", "pval", "Gene ID")
View(main)
main <- na.omit(main)
#Annotate Chromosome Number
mapped_CHR <- as.data.frame(org.Hs.egCHR[mappedkeys(org.Hs.egCHR)])
#Map Entrez Gene ID to Chromosome Number in main dataframe
for (i in 1:nrow(main)){
index = (which(main$`Gene ID`[i] == mapped_CHR$gene_id))
if (length(index) == 1)
{main[i,4] <- as.character(mapped_CHR$chromosome[index])}
else {main[i,4] <- NA}
}
colnames(main)[4] <- "Chr"
main <- na.omit(main)
#Annotate Starting Position
mapped_CHRLOC <- as.data.frame(org.Hs.egCHRLOC[mappedkeys(org.Hs.egCHRLOC)])
for (i in 1:nrow(main)){
index = as.numeric(which(main$`Gene ID`[i] == mapped_CHRLOC$gene_id))
if (length(index) == 1)
{main[i,5] <- abs(mapped_CHRLOC$start_location[index][1])}
else {main[i,5] <- NA}
}
colnames(main)[5] <- "Starting Position"
#Annotate Ending Position
mapped_CHRLOCEND <- as.data.frame(org.Hs.egCHRLOCEND[mappedkeys(org.Hs.egCHRLOCEND)])
for (i in 1:nrow(main)){
index = as.numeric(which(main$`Gene ID`[i] == mapped_CHRLOCEND$gene_id))
if (length(index) == 1)
{main[i,6] <- abs(mapped_CHRLOCEND$end_location[index][1])}
else {main[i,6] <- NA}
}
colnames(main)[6] <- "Ending Position"
main <- na.omit(main)
#Annotate Strand
for (i in 1:nrow(main)){
index = as.numeric(which(main$`Gene ID`[i] == mapped_CHRLOC$gene_id))
if (mapped_CHRLOC$start_location[index] > 0)
{main[i,7] <- "+"}
else {main[i,7] <- "-"}
}
colnames(main)[7] <- "Strand"
print(i)
i = 2
print(i)
gene <- input$`Hugo Symbol`[i]
# Create manhattan object for labelling gene
mp.label <- mp[gene]
mp@ranges@NAMES == gene
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Genomic
genomic.plots(summary.full)
# Cytogenetic location relative to other genes
karyoplots(summary.full)
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Cytogenetic location relative to other genes
karyoplots(summary.full)
source('~/Github/Projects/shiny app V3/plotting functions.R')
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Cytogenetic location relative to other genes
karyoplots(summary.full)
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Cytogenetic location relative to other genes
karyoplots(summary.full)
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Cytogenetic location relative to other genes
karyoplots(summary.full)
load("~/Github/Projects/shiny app V3/shiny app V3.RData")
View(summary.full)
source('~/Github/Projects/shiny app V3/PDF plots.R')
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Rank relative to other genes
gene.rank.dotplot(summary.full)
input <- summary.full
i = 1
h = -log10(0.05)
gene <- input$`Hugo Symbol`[i]
gene.layer <- subset(input,  `Hugo Symbol` == gene)
print((ggplot(input, aes(`Gene Rank`, `-log10(Molecular FDR)`, label = `Hugo Symbol`))
+ geom_point()
+ geom_point(data = gene.layer, colour="red")
+ geom_text_repel(data = subset(input, `Hugo Symbol` == gene), color = "red", nudge_x = 0, nudge_y = .3)
+ geom_hline(yintercept = h , linetype = "solid", color = "red", size = 0.8)
+ geom_text(aes(0,h,label = "FDR = 0.05", vjust = -1))))
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Rank relative to other genes
gene.rank.dotplot(summary.full)
(nrow(input)*0.8)
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Rank relative to other genes
gene.rank.dotplot(summary.full)
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Rank relative to other genes
gene.rank.dotplot(summary.full)
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Rank relative to other genes
gene.rank.dotplot(summary.full)
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Rank relative to other genes
gene.rank.dotplot(summary.full)
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Rank relative to other genes
gene.rank.dotplot(summary.full)
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Rank relative to other genes
gene.rank.dotplot(summary.full)
# Survival
survival.plots(summary.full)
# Survival
survival.plots(summary.full)
gene <- input$`Hugo Symbol`[k]
# Obtain sample names for primary subtype
sample.names <- colnames(TCGA.coloss)[2:ncol(TCGA.coloss)]
sample.names.WT <- colnames(TCGA.WT)[2:ncol(TCGA.WT)]
# Create  coloss data frame of rows = samples | columns = Patient ID, Group, Time, Status
data <- data.frame()
for (i in 1:length(sample.names)){
index <- which(sample.names[i] == clinical.sample$SAMPLE_ID)
sample <- clinical.sample$PATIENT_ID[index]
index2 <- which(sample == clinical.patient$PATIENT_ID)
data[i,1] <- clinical.patient$PATIENT_ID[index2]
if (clinical.patient$DFS_MONTHS[index2] != "[Not Available]") {data[i,2] <- clinical.patient$DFS_MONTHS[index2]}
if (clinical.patient$DFS_STATUS[index2] != "[Not Available]") {data[i,3] <- clinical.patient$DFS_STATUS[index2]}
}
for (i in 1:length(sample.names)){
index <- which(sample.names[i] == colnames(TCGA.mRNA))
index2 <- which(gene == TCGA.mRNA$Hugo_Symbol)
data[i,4] <- TCGA.mRNA[index2,index]
}
data <- na.omit(data)
colnames(data) <- c("Patient ID", "DFS Months", "DFS Status", "Expression")
# Rename status column
for (i in 1:nrow(data)){
if (data[i,3] == "0:DiseaseFree") {data[i,3] <- 0}
if (data[i,3] == "1:Recurred/Progressed") {data[i,3] <- 1}
}
# Order dataset by gene expression. Subset into high and low expressors
data <- data[order(data$Expression, decreasing = TRUE),]
# Stratify patients into n=2 quantiles.
quantiles <- quantile(data$Expression, 0.50)
high.expressing <- data[data$Expression >= quantiles[1],]
high.expressing[,5] <- paste("High", paste(gene, "mRNA Expression", sep = " "), sep = " ")
colnames(high.expressing)[5] <- "Group"
low.expressing <- data[data$Expression <= quantiles[1],]
low.expressing[,5] <- paste("Low", paste(gene, "mRNA Expression", sep = " "), sep = " ")
colnames(low.expressing)[5] <- "Group"
# Prepare dataframe for survival analysis
high.expressing <- high.expressing[,c(1, 5, 2, 3)]
low.expressing <- low.expressing[,c(1, 5, 2, 3)]
surv_data <- rbind(high.expressing, low.expressing)
surv_data$`DFS Months` <- as.numeric(surv_data$`DFS Months`)
surv_data$`DFS Status` <- as.numeric(surv_data$`DFS Status`)
# Make coloss surv object
surv_object <- Surv(time = surv_data$`DFS Months`, event = surv_data$`DFS Status`)
# Create  WT data frame of rows = samples | columns = Patient ID, Group, Time, Status
data <- data.frame()
for (i in 1:length(sample.names.WT)){
index <- which(sample.names.WT[i] == clinical.sample$SAMPLE_ID)
sample <- clinical.sample$PATIENT_ID[index]
index2 <- which(sample == clinical.patient$PATIENT_ID)
data[i,1] <- clinical.patient$PATIENT_ID[index2]
if (clinical.patient$DFS_MONTHS[index2] != "[Not Available]") {data[i,2] <- clinical.patient$DFS_MONTHS[index2]}
if (clinical.patient$DFS_STATUS[index2] != "[Not Available]") {data[i,3] <- clinical.patient$DFS_STATUS[index2]}
}
for (i in 1:length(sample.names.WT)){
index <- which(sample.names.WT[i] == colnames(TCGA.mRNA))
index2 <- which(gene == TCGA.mRNA$Hugo_Symbol)
data[i,4] <- TCGA.mRNA[index2,index]
}
data <- na.omit(data)
colnames(data) <- c("Patient ID", "DFS Months", "DFS Status", "Expression")
# Rename status column
for (i in 1:nrow(data)){
if (data[i,3] == "0:DiseaseFree") {data[i,3] <- 0}
if (data[i,3] == "1:Recurred/Progressed") {data[i,3] <- 1}
}
# Order dataset by gene expression. Subset into high and low expressors
data <- data[order(data$Expression, decreasing = TRUE),]
# Stratify patients into n=2 quantiles.
quantiles <- quantile(data$Expression, 0.50)
high.expressing <- data[data$Expression >= quantiles[1],]
high.expressing[,5] <- paste("High", paste(gene, "mRNA Expression", sep = " "), sep = " ")
colnames(high.expressing)[5] <- "Group"
low.expressing <- data[data$Expression <= quantiles[1],]
low.expressing[,5] <- paste("Low", paste(gene, "mRNA Expression", sep = " "), sep = " ")
colnames(low.expressing)[5] <- "Group"
# Prepare dataframe for survival analysis
high.expressing <- high.expressing[,c(1, 5, 2, 3)]
low.expressing <- low.expressing[,c(1, 5, 2, 3)]
surv_data.WT <- rbind(high.expressing, low.expressing)
surv_data.WT$`DFS Months` <- as.numeric(surv_data.WT$`DFS Months`)
surv_data.WT$`DFS Status` <- as.numeric(surv_data.WT$`DFS Status`)
# Make WT surv object
surv_object.WT <- Surv(time = surv_data.WT$`DFS Months`, event = surv_data.WT$`DFS Status`)
# Make plots
fit <- survfit(surv_object ~ Group, data = surv_data)
fit.WT <- survfit(surv_object.WT ~ Group, data = surv_data.WT)
print((ggsurvplot(fit, pval = TRUE, pval.method = TRUE,
conf.int = TRUE,
risk.table = TRUE,
palette = c("#E7B800", "#2E9FDF"),
risk.table.y.text = FALSE,
ylab = "DFS Ratio",
xlab = "Months",
title = "Primary Subtype Patients")))
print((ggsurvplot(fit.WT, pval = TRUE, pval.method = TRUE,
conf.int = TRUE,
risk.table = TRUE,
palette = c("#E7B800", "#2E9FDF"),
risk.table.y.text = FALSE,
ylab = "DFS Ratio",
xlab = "Months",
title = "Primary WT Patients")))
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Survival
survival.plots(summary.full)
load("~/Github/Projects/shiny app V3/shiny app V3.RData")
source('~/Github/Projects/shiny app V3/PDF plots.R')
input <- summary.full
clinical.sample <- read.table("TCGA clinical sample.txt", header = TRUE, sep = "\t", check.names = FALSE)
clinical.patient <- read.table("TCGA clinical patient.txt", header = TRUE, sep = "\t", check.names = FALSE)
pdf("Survival plots.pdf")
# For each gene in the summary table:
for (k in 1:nrow(input)){
print(k)
gene <- input$`Hugo Symbol`[k]
# Obtain sample names for primary subtype
sample.names <- colnames(TCGA.coloss)[2:ncol(TCGA.coloss)]
sample.names.WT <- colnames(TCGA.WT)[2:ncol(TCGA.WT)]
# Create  coloss data frame of rows = samples | columns = Patient ID, Group, Time, Status
data <- data.frame()
for (i in 1:length(sample.names)){
index <- which(sample.names[i] == clinical.sample$SAMPLE_ID)
sample <- clinical.sample$PATIENT_ID[index]
index2 <- which(sample == clinical.patient$PATIENT_ID)
data[i,1] <- clinical.patient$PATIENT_ID[index2]
if (clinical.patient$DFS_MONTHS[index2] != "[Not Available]") {data[i,2] <- clinical.patient$DFS_MONTHS[index2]}
if (clinical.patient$DFS_STATUS[index2] != "[Not Available]") {data[i,3] <- clinical.patient$DFS_STATUS[index2]}
}
for (i in 1:length(sample.names)){
index <- which(sample.names[i] == colnames(TCGA.mRNA))
index2 <- which(gene == TCGA.mRNA$Hugo_Symbol)
data[i,4] <- TCGA.mRNA[index2,index]
}
data <- na.omit(data)
colnames(data) <- c("Patient ID", "DFS Months", "DFS Status", "Expression")
# Rename status column
for (i in 1:nrow(data)){
if (data[i,3] == "0:DiseaseFree") {data[i,3] <- 0}
if (data[i,3] == "1:Recurred/Progressed") {data[i,3] <- 1}
}
# Order dataset by gene expression. Subset into high and low expressors
data <- data[order(data$Expression, decreasing = TRUE),]
# Stratify patients into n=2 quantiles.
quantiles <- quantile(data$Expression, 0.50)
high.expressing <- data[data$Expression >= quantiles[1],]
high.expressing[,5] <- paste("High", paste(gene, "mRNA Expression", sep = " "), sep = " ")
colnames(high.expressing)[5] <- "Group"
low.expressing <- data[data$Expression <= quantiles[1],]
low.expressing[,5] <- paste("Low", paste(gene, "mRNA Expression", sep = " "), sep = " ")
colnames(low.expressing)[5] <- "Group"
# Prepare dataframe for survival analysis
high.expressing <- high.expressing[,c(1, 5, 2, 3)]
low.expressing <- low.expressing[,c(1, 5, 2, 3)]
surv_data <- rbind(high.expressing, low.expressing)
surv_data$`DFS Months` <- as.numeric(surv_data$`DFS Months`)
surv_data$`DFS Status` <- as.numeric(surv_data$`DFS Status`)
# Make coloss surv object
surv_object <- Surv(time = surv_data$`DFS Months`, event = surv_data$`DFS Status`)
# Create  WT data frame of rows = samples | columns = Patient ID, Group, Time, Status
data <- data.frame()
for (i in 1:length(sample.names.WT)){
index <- which(sample.names.WT[i] == clinical.sample$SAMPLE_ID)
sample <- clinical.sample$PATIENT_ID[index]
index2 <- which(sample == clinical.patient$PATIENT_ID)
data[i,1] <- clinical.patient$PATIENT_ID[index2]
if (clinical.patient$DFS_MONTHS[index2] != "[Not Available]") {data[i,2] <- clinical.patient$DFS_MONTHS[index2]}
if (clinical.patient$DFS_STATUS[index2] != "[Not Available]") {data[i,3] <- clinical.patient$DFS_STATUS[index2]}
}
for (i in 1:length(sample.names.WT)){
index <- which(sample.names.WT[i] == colnames(TCGA.mRNA))
index2 <- which(gene == TCGA.mRNA$Hugo_Symbol)
data[i,4] <- TCGA.mRNA[index2,index]
}
data <- na.omit(data)
colnames(data) <- c("Patient ID", "DFS Months", "DFS Status", "Expression")
# Rename status column
for (i in 1:nrow(data)){
if (data[i,3] == "0:DiseaseFree") {data[i,3] <- 0}
if (data[i,3] == "1:Recurred/Progressed") {data[i,3] <- 1}
}
# Order dataset by gene expression. Subset into high and low expressors
data <- data[order(data$Expression, decreasing = TRUE),]
# Stratify patients into n=2 quantiles.
quantiles <- quantile(data$Expression, 0.50)
high.expressing <- data[data$Expression >= quantiles[1],]
high.expressing[,5] <- paste("High", paste(gene, "mRNA Expression", sep = " "), sep = " ")
colnames(high.expressing)[5] <- "Group"
low.expressing <- data[data$Expression <= quantiles[1],]
low.expressing[,5] <- paste("Low", paste(gene, "mRNA Expression", sep = " "), sep = " ")
colnames(low.expressing)[5] <- "Group"
# Prepare dataframe for survival analysis
high.expressing <- high.expressing[,c(1, 5, 2, 3)]
low.expressing <- low.expressing[,c(1, 5, 2, 3)]
surv_data.WT <- rbind(high.expressing, low.expressing)
surv_data.WT$`DFS Months` <- as.numeric(surv_data.WT$`DFS Months`)
surv_data.WT$`DFS Status` <- as.numeric(surv_data.WT$`DFS Status`)
# Make WT surv object
surv_object.WT <- Surv(time = surv_data.WT$`DFS Months`, event = surv_data.WT$`DFS Status`)
# Make plots
fit <- survfit(surv_object ~ Group, data = surv_data)
fit.WT <- survfit(surv_object.WT ~ Group, data = surv_data.WT)
print((ggsurvplot(fit, pval = TRUE, pval.method = TRUE,
conf.int = TRUE,
risk.table = TRUE,
palette = c("#E7B800", "#2E9FDF"),
risk.table.y.text = FALSE,
ylab = "DFS Ratio",
xlab = "Months",
title = "Primary Subtype Patients")))
print((ggsurvplot(fit.WT, pval = TRUE, pval.method = TRUE,
conf.int = TRUE,
risk.table = TRUE,
palette = c("#E7B800", "#2E9FDF"),
risk.table.y.text = FALSE,
ylab = "DFS Ratio",
xlab = "Months",
title = "Primary WT Patients")))
}
View(input)
dev.off()
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Survival
survival.plots(summary.full)
source('~/Github/Projects/shiny app V3/PDF plots.R')
load("~/Github/Projects/shiny app V3/shiny app V3.RData")
source('~/Github/Projects/shiny app V3/PDF plots.R')
# Survival
survival.plots(summary.full)
# Survival
survival.plots(summary.full)
# Survival
survival.plots(summary.full)
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Survival
survival.plots(summary.full)
i = 42
gene <- input$`Hugo Symbol`[k]
input <- summary.full
k = 1
print(k)
gene <- input$`Hugo Symbol`[k]
# Obtain sample names for primary subtype
sample.names <- colnames(TCGA.coloss)[2:ncol(TCGA.coloss)]
sample.names.WT <- colnames(TCGA.WT)[2:ncol(TCGA.WT)]
# Create  coloss data frame of rows = samples | columns = Patient ID, Group, Time, Status
data <- data.frame()
for (i in 1:length(sample.names)){
print(i)
index <- which(sample.names[i] == clinical.sample$SAMPLE_ID)
sample <- clinical.sample$PATIENT_ID[index]
index2 <- which(sample == clinical.patient$PATIENT_ID)
data[i,1] <- clinical.patient$PATIENT_ID[index2]
if (clinical.patient$DFS_MONTHS[index2] != "[Not Available]") {data[i,2] <- clinical.patient$DFS_MONTHS[index2]}
if (clinical.patient$DFS_STATUS[index2] != "[Not Available]") {data[i,3] <- clinical.patient$DFS_STATUS[index2]}
}
clinical.sample <- read.table("TCGA clinical sample.txt", header = TRUE, sep = "\t", check.names = FALSE)
clinical.patient <- read.table("TCGA clinical patient.txt", header = TRUE, sep = "\t", check.names = FALSE)
pdf("Survival plot.pdf")
# For each gene in the summary table:
for (k in 1:nrow(input)){
print(k)
gene <- input$`Hugo Symbol`[k]
# Obtain sample names for primary subtype
sample.names <- colnames(TCGA.coloss)[2:ncol(TCGA.coloss)]
sample.names.WT <- colnames(TCGA.WT)[2:ncol(TCGA.WT)]
# Create  coloss data frame of rows = samples | columns = Patient ID, Group, Time, Status
data <- data.frame()
for (i in 1:length(sample.names)){
index <- which(sample.names[i] == clinical.sample$SAMPLE_ID)
sample <- clinical.sample$PATIENT_ID[index]
index2 <- which(sample == clinical.patient$PATIENT_ID)
data[i,1] <- clinical.patient$PATIENT_ID[index2]
if (clinical.patient$DFS_MONTHS[index2] != "[Not Available]") {data[i,2] <- clinical.patient$DFS_MONTHS[index2]}
if (clinical.patient$DFS_STATUS[index2] != "[Not Available]") {data[i,3] <- clinical.patient$DFS_STATUS[index2]}
}
for (i in 1:length(sample.names)){
index <- which(sample.names[i] == colnames(TCGA.mRNA))
index2 <- which(gene == TCGA.mRNA$Hugo_Symbol)
data[i,4] <- TCGA.mRNA[index2,index]
}
data <- na.omit(data)
colnames(data) <- c("Patient ID", "DFS Months", "DFS Status", "Expression")
# Rename status column
for (i in 1:nrow(data)){
if (data[i,3] == "0:DiseaseFree") {data[i,3] <- 0}
if (data[i,3] == "1:Recurred/Progressed") {data[i,3] <- 1}
}
# Order dataset by gene expression. Subset into high and low expressors
data <- data[order(data$Expression, decreasing = TRUE),]
# Stratify patients into n=2 quantiles.
quantiles <- quantile(data$Expression, 0.50)
high.expressing <- data[data$Expression >= quantiles[1],]
high.expressing[,5] <- paste("High", paste(gene, "mRNA Expression", sep = " "), sep = " ")
colnames(high.expressing)[5] <- "Group"
low.expressing <- data[data$Expression <= quantiles[1],]
low.expressing[,5] <- paste("Low", paste(gene, "mRNA Expression", sep = " "), sep = " ")
colnames(low.expressing)[5] <- "Group"
# Prepare dataframe for survival analysis
high.expressing <- high.expressing[,c(1, 5, 2, 3)]
low.expressing <- low.expressing[,c(1, 5, 2, 3)]
surv_data <- rbind(high.expressing, low.expressing)
surv_data$`DFS Months` <- as.numeric(surv_data$`DFS Months`)
surv_data$`DFS Status` <- as.numeric(surv_data$`DFS Status`)
# Make coloss surv object
surv_object <- Surv(time = surv_data$`DFS Months`, event = surv_data$`DFS Status`)
# Create  WT data frame of rows = samples | columns = Patient ID, Group, Time, Status
data <- data.frame()
for (i in 1:length(sample.names.WT)){
index <- which(sample.names.WT[i] == clinical.sample$SAMPLE_ID)
sample <- clinical.sample$PATIENT_ID[index]
index2 <- which(sample == clinical.patient$PATIENT_ID)
data[i,1] <- clinical.patient$PATIENT_ID[index2]
if (clinical.patient$DFS_MONTHS[index2] != "[Not Available]") {data[i,2] <- clinical.patient$DFS_MONTHS[index2]}
if (clinical.patient$DFS_STATUS[index2] != "[Not Available]") {data[i,3] <- clinical.patient$DFS_STATUS[index2]}
}
for (i in 1:length(sample.names.WT)){
index <- which(sample.names.WT[i] == colnames(TCGA.mRNA))
index2 <- which(gene == TCGA.mRNA$Hugo_Symbol)
data[i,4] <- TCGA.mRNA[index2,index]
}
data <- na.omit(data)
colnames(data) <- c("Patient ID", "DFS Months", "DFS Status", "Expression")
# Rename status column
for (i in 1:nrow(data)){
if (data[i,3] == "0:DiseaseFree") {data[i,3] <- 0}
if (data[i,3] == "1:Recurred/Progressed") {data[i,3] <- 1}
}
# Order dataset by gene expression. Subset into high and low expressors
data <- data[order(data$Expression, decreasing = TRUE),]
# Stratify patients into n=2 quantiles.
quantiles <- quantile(data$Expression, 0.50)
high.expressing <- data[data$Expression >= quantiles[1],]
high.expressing[,5] <- paste("High", paste(gene, "mRNA Expression", sep = " "), sep = " ")
colnames(high.expressing)[5] <- "Group"
low.expressing <- data[data$Expression <= quantiles[1],]
low.expressing[,5] <- paste("Low", paste(gene, "mRNA Expression", sep = " "), sep = " ")
colnames(low.expressing)[5] <- "Group"
# Prepare dataframe for survival analysis
high.expressing <- high.expressing[,c(1, 5, 2, 3)]
low.expressing <- low.expressing[,c(1, 5, 2, 3)]
surv_data.WT <- rbind(high.expressing, low.expressing)
surv_data.WT$`DFS Months` <- as.numeric(surv_data.WT$`DFS Months`)
surv_data.WT$`DFS Status` <- as.numeric(surv_data.WT$`DFS Status`)
# Make WT surv object
surv_object.WT <- Surv(time = surv_data.WT$`DFS Months`, event = surv_data.WT$`DFS Status`)
# Make plots
fit <- survfit(surv_object ~ Group, data = surv_data)
fit.WT <- survfit(surv_object.WT ~ Group, data = surv_data.WT)
print((ggsurvplot(fit, pval = TRUE, pval.method = TRUE,
conf.int = TRUE,
risk.table = TRUE,
palette = c("#E7B800", "#2E9FDF"),
risk.table.y.text = FALSE,
ylab = "DFS Ratio",
xlab = "Months",
title = "Primary Subtype Patients")))
print((ggsurvplot(fit.WT, pval = TRUE, pval.method = TRUE,
conf.int = TRUE,
risk.table = TRUE,
palette = c("#E7B800", "#2E9FDF"),
risk.table.y.text = FALSE,
ylab = "DFS Ratio",
xlab = "Months",
title = "Primary WT Patients")))
}
dev.off()
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Survival
survival.plots(summary.full)
source('~/Github/Projects/shiny app V3/PDF plots.R')
source('~/Github/Projects/shiny app V3/PDF plots.R')
# Survival
survival.plots(summary.full)
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Survival
survival.plots(summary.full)
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Survival
survival.plots(summary.full)
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Survival
survival.plots(summary.full)
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Survival
survival.plots(summary.full)
source('~/Github/Projects/shiny app V3/plotting functions.R')
# Output plots to PDF
source("plotting functions.R")
# Survival
survival.plots(summary.full)
source('~/Github/Projects/shiny app V3/PDF plots.R')
